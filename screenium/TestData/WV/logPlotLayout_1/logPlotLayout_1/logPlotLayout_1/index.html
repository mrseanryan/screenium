<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>log plot layout tryout</title>

    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

    <link href="http://cdn.kendostatic.com/2015.2.624/styles/kendo.common.min.css" rel="stylesheet" />
    <link href="http://cdn.kendostatic.com/2015.2.624/styles/kendo.default.min.css" rel="stylesheet" />

    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

    <script src="http://cdn.kendostatic.com/2015.2.624/js/kendo.all.min.js"></script>
    <!--<script src="http://cdn.kendostatic.com/2015.2.624/js/kendo.timezones.min.js"></script>-->
</head>
<body>
    <!-- WV uses tables for zones:-->
    <table>
        <tr>
            <td id="tdZone1" width="600px">
                <div id="zone1">
                    <!-- LP here in zone 1 -->
                    <!--LP control: width and height-->
                    <div id="example" style="border: solid 1px black; height: 700px; width:500px;">

                        <div id="vertical" style="height: 97%; width: 99%;">
                            <div id="top-pane">
                                <div id="horizontal-headings" style="height: 100%; width: 100%;">
                                    <div id="ruler-pane-heading-1">
                                        <div class="pane-content">
                                            <h3>ruler header</h3>
                                        </div>
                                    </div>
                                    <div id="column1-pane-heading-1">
                                        <div class="pane-content">
                                            <h3>col 1 - header</h3>
                                        </div>
                                    </div>
                                    <div id="column2-pane-heading-1">
                                        <div class="pane-content">
                                            <h3>col 2 - header</h3>
                                        </div>
                                    </div>
                                    <div id="column3-pane-heading-1">
                                        <div class="pane-content">
                                            <h3>col 3 - header</h3>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="middle-pane">
                                <div id="horizontal-main" style="height: 100%; width: 100%;">
                                    <div id="ruler-pane-main">
                                        <img src="images/wv_lp_ruler_main.png" class="stretch-image" />
                                    </div>
                                    <div id="column1-pane-main">
                                        <img src="images/wv_lp_column1_main.png" class="stretch-image" />
                                    </div>
                                    <div id="column2-pane-main">
                                        <img src="images/wv_lp_column2_main.png" class="stretch-image" />
                                    </div>
                                    <div id="column3-pane-main">
                                        <img src="images/wv_lp_column3_main.png" class="stretch-image" />
                                    </div>
                                </div>
                            </div>
                            <div id="bottom-pane">
                                <div id="horizontal-footers" style="height: 100%; width: 100%;">
                                    <div id="ruler-pane-footer">
                                        <!--empty-->
                                    </div>
                                    <div id="column1-pane-footer">
                                        <img src="images/wv_lp_column1_footer.png" class="stretch-image" />
                                    </div>
                                    <div id="column2-pane-footer">
                                        <img src="images/wv_lp_column2_footer.png" class="stretch-image" />
                                    </div>
                                    <div id="column3-pane-footer">
                                        <img src="images/wv_lp_column3_footer.png" class="stretch-image" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="verticalSpaceAtBottom" style="height:15px;">&nbsp;</div>
                    </div>

                    <script>
                        var mainVerticalSplitter;
                        var headingsHorizontalSplitter;
                        var headings2HorizontalSplitter;
                        var mainHorizontalSplitter;
                        var footersHorizontalSplitter;

                        var createKendoSplitters = function () {

                            $("#vertical").kendoSplitter({
                                orientation: "vertical",
                                panes: [
                                    { collapsible: true, resizable: true, size: "50px" }, //headings
                                    { collapsible: false, resizable: true }, //main
                                    { collapsible: true, resizable: true, size: "50px" } //footer
                                ]
                            });
                            mainVerticalSplitter = $("#vertical").data("kendoSplitter");

                            $("#horizontal-headings").kendoSplitter({
                                panes: [
                                    { collapsible: false, resizable: false, scrollable: false },
                                    { collapsible: false, resizable: false, scrollable: false },
                                    { collapsible: false, resizable: false, scrollable: false },
                                    { collapsible: false, resizable: false, scrollable: false }
                                ]
                            });
                            headingsHorizontalSplitter = $("#horizontal-headings").data("kendoSplitter");

                            $("#horizontal-main").kendoSplitter({
                                panes: [
                                    { collapsible: true, scrollable: false },
                                    { collapsible: true, scrollable: false },
                                    { collapsible: true, scrollable: false },
                                    { collapsible: true, scrollable: false }
                                ],
                                expand: onExpandMainHorizontal,
                                collapse: onCollapseMainHorizontal,
                                contentload: onContentLoadMainHorizontal,
                                resize: onResizeMainHorizontal
                            });
                            mainHorizontalSplitter = $("#horizontal-main").data('kendoSplitter');

                            $("#horizontal-footers").kendoSplitter({
                                panes: [
                                    { collapsible: false, resizable: false, scrollable: false },
                                    { collapsible: false, resizable: false, scrollable: false },
                                    { collapsible: false, resizable: false, scrollable: false },
                                    { collapsible: false, resizable: false, scrollable: false }
                                ]
                            });
                            footersHorizontalSplitter = $("#horizontal-footers").data('kendoSplitter');
                        };

                        $(document).ready(function () {

                            createKendoSplitters();

                            //jQuery resizable:
                            $('#example').resizable({
                                //handles: "e"
                            });
                        });

                        //adjust the pane sizes, after some resize event.
                        //unfortunately, kendo ui does not always provide the pane object that was resized.
                        //so, this function adjusts ALL panes, taking Main as the authority.
                        var adjustPaneSizes = function () {
                            var authorityPaneSuffix = '-pane-main';
                            var columnPrefixes = [
                                'ruler', 'column1', 'column2', 'column3'
                            ];

                            var rowSuffixes = [
                                '-pane-heading-1', '-pane-footer'
                            ];
                            var rowSuffixToSplitter = [];

                            //using Null Object to handle edge cases during control creation (where 1 or more row splitters not yet created)
                            var nullObjectSplitter = {
                                size: function() {
                                }
                            };

                            rowSuffixToSplitter[rowSuffixes[0]] = headingsHorizontalSplitter ? headingsHorizontalSplitter : nullObjectSplitter;
                            rowSuffixToSplitter[rowSuffixes[1]] = footersHorizontalSplitter ? footersHorizontalSplitter : nullObjectSplitter;

                            var resizeOtherPanesInColumn = function (columnPrefix) {
                                var authorityPaneId = columnPrefix + authorityPaneSuffix;
                                var authorityPane = getPane(authorityPaneId);
                                var size = authorityPane.size;
                                if(authorityPane.collapsed) {
                                    size = 0;
                                }
                                if (typeof (size) === 'undefined') {
                                    //bug in kendo ui?
                                    size = $('#' + authorityPaneId).width();
                                }

                                for (var rowSuffix in rowSuffixes) {
                                    if(rowSuffixes.hasOwnProperty(rowSuffix)) {
                                        rowSuffix = rowSuffixes[rowSuffix];
                                        var targetPaneId = columnPrefix + rowSuffix;

                                        var splitter = rowSuffixToSplitter[rowSuffix];
                                        splitter.size('#' + targetPaneId, size);
                                    }
                                }
                            };

                            for(var columnPrefix in columnPrefixes) {
                                if (columnPrefixes.hasOwnProperty(columnPrefix)) {
                                    columnPrefix = columnPrefixes[columnPrefix];
                                    resizeOtherPanesInColumn(columnPrefix);
                                }
                            }
                        };

                        var getPane = function (id) {
                            return $('#' + id).data('pane');
                        };

                        function onResizeMainHorizontal(e) {
                            console.log("Resized :: Splitter <b>#" + this.element[0].id + "</b>");
                            adjustPaneSizes();
                        }

                        function onExpandMainHorizontal(e) {
                            console.log("Expanded :: Pane <b>#" + e.pane.id + "</b> from splitter <b>#" + this.element[0].id + "</b> expanded");
                            adjustPaneSizes();
                        }

                        function onCollapseMainHorizontal(e) {
                            console.log("Collapsed :: Pane <b>#" + e.pane.id + "</b> from splitter <b>#" + this.element[0].id + "</b> collapsed");
                            adjustPaneSizes();
                        }

                        function onContentLoadMainHorizontal(e) {
                            console.log("Content loaded in <b>#" + e.pane.id +
                                "</b> and starts with <b>" + $(e.pane).text().substr(0, 20) + "...</b>");
                        }
                    </script>

                    <style>
                        #example {
                        }

                        #vertical {
                            margin: 0 auto;
                        }

                        .pane-content {
                            padding: 0 10px;
                        }

                        .stretch-image {
                            margin: 0;
                            height: 99%;
                            width: 100%;
                        }
                    </style>
                </div>
            </td>
        </tr>
    </table>

</body>
</html>
